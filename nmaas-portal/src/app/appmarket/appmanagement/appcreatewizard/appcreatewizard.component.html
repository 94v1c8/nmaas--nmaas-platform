<p-steps [model]="steps" [(activeIndex)]="activeStepIndex"></p-steps>
<hr/>

    <div *ngIf="activeStepIndex === 0">
        <div class="panel">
            <p class="text-center">Lorem ipsum</p>
        </div>
        <input type="checkbox" [checked]="rulesAccepted" (click)="changeRulesAcceptedFlag()"> I have accepted the rules
        <button class="btn btn-success pull-right" (click)="nextStep()" [disabled]="!rulesAccepted">Next</button>
    </div>

    <div *ngIf="activeStepIndex === 1">
        <div *ngIf="app">
            <div class="panel">
                <form class="form-horizontal" #basicInfoForm="ngForm">
                    <div class="form-group form-group-sm"
                         [ngClass]="{'has-error':  appName.invalid && (appName.dirty || appName.touched),
 			    		 	'has-success': appName.valid && (appName.dirty || appName.touched)}">
                        <label for="appName" class="control-label">Name *</label>
                        <br>
                        <input type="text" id="appName" class="form-control" required [(ngModel)]="app.name" name="appName" #appName="ngModel">
                    </div>
                    <div class="form-group form-group-sm"
                         [ngClass]="{'has-error':  version.invalid && (version.dirty || version.touched),
 			    		 	'has-success': version.valid && (version.dirty || version.touched)}">
                        <label for="appVersion" class="control-label">Version *</label>
                        <br>
                        <input type="text" id="appVersion" class="form-control" required [(ngModel)]="app.version" name="version" #version="ngModel">
                    </div>
                    <div class="form-group form-group-sm"
                         [ngClass]="{'has-error':  license.invalid && (license.dirty || license.touched),
 			    		 	'has-success': license.valid && (license.dirty || license.touched)}">
                        <label for="appLicense" class="control-label">License *</label>
                        <br>
                        <input type="text" id="appLicense" class="form-control" required [(ngModel)]="app.license" name="license" #license="ngModel">
                    </div>
                    <div class="form-group form-group-sm"
                         [ngClass]="{'has-error':  licenseUrl.invalid && (licenseUrl.dirty || licenseUrl.touched),
 				    	 	'has-success': licenseUrl.valid && (licenseUrl.dirty || licenseUrl.touched)}">
                        <label for="appLicenseUrl" class="control-label">License url *</label>
                        <br>
                        <input type="url" id="appLicenseUrl" class="form-control" required [(ngModel)]="app.licenseUrl" name="licenseUrl" #licenseUrl="ngModel" placeholder="e.g. https://opensource.org/licenses/MIT">
                    </div>
                    <div class="form-group form-group-sm"
                         [ngClass]="{'has-error':  wwwUrl.invalid && (wwwUrl.dirty || wwwUrl.touched),
 				    	 	'has-success': wwwUrl.valid && (wwwUrl.dirty || wwwUrl.touched)}">
                        <label for="wwwUrl" class="control-label">Project website *</label>
                        <br>
                        <input type="url" id="wwwUrl" class="form-control" required name="wwwUrl" #wwwUrl="ngModel" [(ngModel)]="app.wwwUrl">
                    </div>
                    <div class="form-group form-group-sm"
                         [ngClass]="{'has-error':  sourceUrl.invalid && (sourceUrl.dirty || sourceUrl.touched),
 				    	 	'has-success': sourceUrl.valid && (sourceUrl.dirty || sourceUrl.touched)}">
                        <label for="sourceUrl" class="control-label">Link to source code *</label>
                        <br>
                        <input type="url" id="sourceUrl" class="form-control" required name="sourceUrl" #sourceUrl="ngModel" [(ngModel)]="app.sourceUrl">
                    </div>
                    <div class="form-group form-group-sm"
                         [ngClass]="{'has-error':  issuesUrl.invalid && (issuesUrl.dirty || issuesUrl.touched),
 				    	 	'has-success': issuesUrl.valid && (issuesUrl.dirty || issuesUrl.touched)}">
                        <label for="issuesUrl" class="control-label">Link to project issues *</label>
                        <br>
                        <input type="url" id="issuesUrl" class="form-control" required name="issuesUrl" #issuesUrl="ngModel" [(ngModel)]="app.issuesUrl">
                    </div>
                    <div class="form-group form-group-sm">
                        <label for="tags" class="control-label">Select tags for application * </label>
                        <br>
                        <p-multiSelect id="tags" [panelStyle]="{minWidth:'25em'}" [options]="tags" required [(ngModel)]="app.tags" name="tags" defaultLabel="Choose | Wybierz"></p-multiSelect>
                    </div>
                </form>
            </div>
            <button class="btn btn-success pull-right" (click)="nextStep()" [disabled]="basicInfoForm.invalid">Next</button>
        </div>
    </div>

    <div *ngIf="activeStepIndex === 2">
        <div class="panel">
            <div class="panel-heading">
                Uploading logo
            </div>
            <div class="panel-body">
                <p-fileUpload name="logo" customUpload="true" (onSelect)="getLogoUrl($event)" (onRemove)="clearLogo($event)" (onClear)="clearLogo($event)" accept="image/*" maxFileSize="1000000" [showUploadButton]=false [showCancelButton]="false">
                </p-fileUpload>
                <div class="thumbnail">
                    <img id = "logo" [src]="logo?.objectURL || 'assets/images/app-logo-example.png'" alt="Logo" [width]="200" [height]="200">
                </div>
            </div>
        </div>
        <div class="panel">
            <div class="panel-heading">
                Upload screenshots
            </div>
            <div class="panel-body">
                <p-fileUpload name="screenshots" customUpload="true" [multiple]="true" [files]="screenshots" accept="image/*" maxFileSize="2000000" [showUploadButton]="false" [showCancelButton]="false">
                </p-fileUpload>
                <div class="carousel slide media-carousel col-md-12" id="media" *ngIf="screenshots && screenshots.length > 0">
                    <div class="carousel-inner">
                        <div class="item" *ngFor="let row of screenshots | group:3; let firstRow = last" [ngClass]="{'active': firstRow}">
                            <div class="row">
                                <div class="col-md-4" *ngFor="let screenshot of row">
                                    <a class="thumbnail">
                                        <img alt="Screenshot" [src]="screenshot.objectURL || 'assets/images/app-screenshot-example.png'">
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <a data-slide="prev" href="#media" class="left carousel-control" *ngIf="screenshots.length > 3">&lt;</a>
                    <a data-slide="next" href="#media" class="right carousel-control" *ngIf="screenshots.length > 3">&gt;</a>
                </div>
            </div>
        </div>
        <button class="btn btn-success pull-right" (click)="nextStep()">Next</button>
    </div>
    <div *ngIf="activeStepIndex === 3">
        <div *ngIf="app">
            <form class="form-horizontal" #descriptionForm="ngForm">
                <div class="panel" *ngFor="let appDescription of app.descriptions">
                    <div class="panel-heading">
                        <div *ngIf="appDescription.language === 'en'"><img alt="language" src="assets/images/country/{{appDescription.language}}_circle.png" style="height: 22px"> {{appDescription.language.toUpperCase()}} *</div>
                        <div *ngIf="appDescription.language != 'en'"><img alt="language" src="assets/images/country/{{appDescription.language}}_circle.png" style="height: 22px"> {{appDescription.language.toUpperCase()}}</div>
                    </div>
                    <div class="panel-body">
                        <div class="form-group form-group-sm" *ngIf="appDescription.language != 'en'">
                            <label for="briefDescription" class="col-sm-2 control-label">Brief description</label>
                            <div class="col-sm-10">
                            <textarea class="form-control" id="briefDescription" name="briefDescription" [maxLength]="200"
                                      [(ngModel)]="appDescription.briefDescription" *ngIf="appDescription.language != 'en'"></textarea>
                            </div>
                        </div>
                        <div class="form-group form-group-sm" *ngIf="appDescription.language === 'en'" [ngClass]="{'has-error':  !appDescription.briefDescription || appDescription.briefDescription === '',
 			    		 	'has-success': appDescription.briefDescription && appDescription.briefDescription != ''}">
                            <label for="enBriefDescription" class="col-sm-2 control-label">Brief description</label>
                            <div class="col-sm-10">
                            <textarea class="form-control" id="enBriefDescription" name="enBriefDescription" [maxLength]="200"
                                      [(ngModel)]="appDescription.briefDescription" required></textarea>
                            </div>
                        </div>
                        <div class="form-group form-group-sm" *ngIf="appDescription.language != 'en'">
                            <label for="fullDescription" class="col-sm-2 control-label">Full description</label>
                            <div class="col-sm-10">
                            <textarea class="form-control" id="fullDescription" name="fullDescription"
                                      [(ngModel)]="appDescription.fullDescription"></textarea>
                            </div>
                        </div>
                        <div class="form-group form-group-sm" *ngIf="appDescription.language === 'en'" [ngClass]="{'has-error':  !appDescription.fullDescription || appDescription.fullDescription === '',
 			    		 	'has-success': appDescription.fullDescription && appDescription.fullDescription != ''}">
                            <label for="enFullDescription" class="col-sm-2 control-label">Full description</label>
                            <div class="col-sm-10">
                            <textarea class="form-control" id="enFullDescription" name="enFullDescription"
                                      [(ngModel)]="appDescription.fullDescription" required></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
            <button class="btn btn-success pull-right" (click)="nextStep()" [disabled]="descriptionForm.invalid">Next</button>
        </div>
    </div>
    <div *ngIf="activeStepIndex === 4">
        <div *ngIf="app">
            <div class="panel">
                <div class="panel-heading">Application deployment specification</div>
                <form class="form-horizontal" #appDeploymentForm="ngForm">
                    <div class="panel-body">
                        <div class="form-group form-group-sm" [ngClass]="{'has-error':  kubernetesTemplateChartName.invalid && (kubernetesTemplateChartName.dirty || kubernetesTemplateChartName.touched),
 			    		 	'has-success': kubernetesTemplateChartName.valid && (kubernetesTemplateChartName.dirty || kubernetesTemplateChartName.touched)}">
                            <label for="kubernetesTemplateChartName" class="control-label">Chart name *</label>
                            <br>
                            <input type="text" class="form-control" id="kubernetesTemplateChartName" required name="kubernetesTemplateChartName"
                                   [(ngModel)]="app.appDeploymentSpec.kubernetesTemplate.chart.name" #kubernetesTemplateChartName="ngModel">
                        </div>
                        <div class="form-group form-group-sm">
                            <label for="kubernetesTemplateChartVersion" class="control-label">Chart version</label>
                            <br>
                            <input type="text" class="form-control" id="kubernetesTemplateChartVersion" name="kubernetesTemplateChartVersion"
                                   [(ngModel)]="app.appDeploymentSpec.kubernetesTemplate.chart.version">
                        </div>
                        <div class="form-group form-group-sm">
                            <label for="kubernetesTemplateChartArchive" class="control-label">Archive</label>
                            <br>
                            <input type="text" class="form-control" id="kubernetesTemplateChartArchive" name="kubernetesTemplateChartArchive"
                                   [(ngModel)]="app.appDeploymentSpec.kubernetesTemplate.archive">
                        </div>
                        <div class="form-group form-group-sm" [ngClass]="{'has-error':  storageSpace.invalid && (storageSpace.dirty || storageSpace.touched),
 			    		 	'has-success': storageSpace.valid && (storageSpace.dirty || storageSpace.touched)}">
                            <label for="defaultStorageSpace" class="control-label">Default storage space *</label>
                            <br>
                            <input type="number" class="form-control no-spin" id="defaultStorageSpace" name="defaultStorageSpace" [min]="1" required
                                   [(ngModel)]="app.appDeploymentSpec.defaultStorageSpace" #storageSpace="ngModel">
                        </div>
                        <div class="form-group form-group-sm" *ngFor="let val of getParametersTypes()">
                            <label for="val" class="control-label">Deploy parameter: {{val}}</label>
                            <br>
                            <input type="text" class="form-control" id="val" name="val" (change)="addToDeployParametersMap(val, $event)" [value]="getDeployParameterValue(val)">
                        </div>
                        <div class="form-group form-group-sm">
                            <label for="configFileRepositoryRequired" class="col-sm-2 control-label">Repository required</label>
                            <div class="col-sm-10">
                                <input type="checkbox" id="configFileRepositoryRequired" name="configFileRepositoryRequired"
                                       [defaultChecked]="false" [(ngModel)]="app.appDeploymentSpec.configFileRepositoryRequired">
                            </div>
                        </div>
                    </div>
                </form>
                <hr>
                <div class="panel">
                    <div class="panel-heading">Application configuration wizard template</div>
                    <div class="panel-body">
                        <form-builder *ngIf="isInMode(ComponentMode.CREATE)" [form]="configTemplateService.getConfigTemplate()" (change)="setConfigTemplate($event)"></form-builder>
                        <form-builder *ngIf="isInMode(ComponentMode.EDIT)" [form]="app.configTemplate.template" (change)="setConfigTemplate($event)"></form-builder>
                    </div>
                </div>
                <div class="panel">
                    <div class="panel-heading">Application update configuration wizard template</div>
                    <div class="panel-body">
                        <form-builder *ngIf="isInMode(ComponentMode.CREATE) || !app.configurationUpdateTemplate" [form]="configTemplateService.getConfigUpdateTemplate()" (change)="setUpdateConfigTemplate($event)"></form-builder>
                        <form-builder *ngIf="isInMode(ComponentMode.EDIT) && app.configurationUpdateTemplate" [form]="app.configurationUpdateTemplate.template" (change)="setUpdateConfigTemplate($event)"></form-builder>
                    </div>
                </div>
            </div>
            <button class="btn btn-success pull-right" [disabled]="appDeploymentForm.invalid" (click)="nextStep()">Next</button>
        </div>
    </div>
    <div *ngIf="activeStepIndex === 5">
        <div class="alert alert-danger" *ngIf="errorMessage">
            {{errorMessage}}
        </div>
        <button class="btn btn-success pull-right" (click)="addApplication()" *ngIf="activeStepIndex == 5 && isInMode(ComponentMode.CREATE)" [disabled]="isInvalidDescriptions()">Submit</button>
        <button class="btn btn-success pull-right" (click)="updateApplication()" *ngIf="activeStepIndex == 5 && isInMode(ComponentMode.EDIT)" [disabled]="isInvalidDescriptions()">Submit</button>
    </div>
    <button class="btn btn-warning pull-left" (click)="previousStep()" *ngIf="activeStepIndex != 0">Previous</button>

<nmaas-modal>
    <div class="nmaas-modal-header">
        <h4 style="text-align: center">New application submitted correctly</h4>
    </div>
    <div class="nmaas-modal-body">
        <div class="form-group text-center">
            <p>Thank you for submitting new application. Your request must be now reviewed by NMaaS Team. It may take some time.</p>
        </div>
    </div>
    <div class="nmaas-modal-footer">
        <button class="btn btn-danger center-block" [routerLink]="['/management/apps']">Back to app management</button>
    </div>
</nmaas-modal>