		
		<div class="container">
			<div class="row">
				<div class="col-xs-4 col-sm-3 col-md-3 col-lg-2">
					<div class="thumbnail" *ngIf="app">
						<img alt="App logo" [src]="(appImagesService.getAppLogoUrl(app?.id) | secure) || 'assets/images/app-logo-example.png'"/>
					</div>
					<div class="thumbnail" *ngIf="!app">
						<img alt="App logo" src="assets/images/app-logo-example.png"/>
					</div>
				</div>
				<div class="col-xs-8 col-sm-9 col-md-9 col-lg-10">
					<div class="row">
						<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
							<h2>{{appInstance?.name}}</h2>
							<h3>{{app?.name}}</h3>
						</div>
						<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">				
							<div class="btn-group pull-right">
								<a role="button" href="{{app?.wwwUrl}}" class="btn btn-default">WWW</a>
								<a role="button" href="{{app?.sourceUrl}}" class="btn btn-default">{{'APP_INSTANCE.SOURCE' | translate}}</a>
								<a role="button" href="{{app?.issuesUrl}}" class="btn btn-default">{{'APP_INSTANCE.ISSUES' | translate}}</a>
							</div>
						</div>
					</div>
					
					<hr>
					<div class="row">
						<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
							{{'APP_INSTANCE.VERSION' | translate}}: {{app?.version}}
						</div>
						<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
							{{'APP_INSTANCE.LICENSE' | translate}}: {{app?.license}}
						</div>
					</div>
					<div class="row">
						<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
							{{'APP_INSTANCE.TAGS' | translate}}: {{app?.tags.join(", ")}}
						</div>
					</div>
					<hr>
					<div *ngIf="app" class="row">
						<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
							<p>
								<span>{{'APP_INSTANCE.RATING' | translate}}:</span>
								<rate [pathUrl]="'/apps/' + app?.id + '/rate'"></rate>
							</p>
						</div>
						<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">	
							<p>
								<span>{{'APP_INSTANCE.MY_RATING' | translate}}:</span>
								<rate [editable]="true" (onChange)="onRateChanged()" [pathUrl]="'/apps/' + app?.id + '/rate/my'"></rate>
							</p>
						</div>
						<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
							<div class = "btn-group pull-right" *ngIf="appInstanceStatus?.state !== AppInstanceState[AppInstanceState.FAILURE]">
								<a *ngIf="appInstanceStatus?.state === AppInstanceState[AppInstanceState.RUNNING] && appInstance?.url" href="{{appInstance?.url}}" class = "btn btn-success" role = "button">{{'APP_INSTANCE.GO_TO_APP_BUTTON' | translate}}</a>
								<button *ngIf="appInstanceStatus?.state === AppInstanceState[AppInstanceState.RUNNING]" class = "btn btn-danger" (click)="this.undeployModal.show()">{{'APP_INSTANCE.UNDEPLOY_BUTTON' | translate}}</button>
							</div>
							<div class="btn-group pull-right" *ngIf="appInstanceStatus?.state === AppInstanceState[AppInstanceState.RUNNING]">
								<button class="btn btn-primary" (click)="this.modal.show()">{{'APP_INSTANCE.RESTART_BUTTON' | translate}}</button>
							</div>
							<div class="btn-group pull-right" *ngIf="appInstanceStatus?.state === AppInstanceState[AppInstanceState.FAILURE]">
								<button class="btn btn-primary" (click)="redeploy()">{{'APP_INSTANCE.REDEPLOY_BUTTON' | translate}}</button>
							</div>
						</div>
					</div>
				</div>
			</div>

			<nmaas-modal>
				<div class="nmaas-modal-header">
					<h4 style="text-align: center">{{'UNDEPLOY_MODAL.HEADER' | translate}}</h4>
				</div>
				<div class="nmaas-modal-body">
					<div class="form-group">
						<p>{{'UNDEPLOY_MODAL.BODY' | translate}}</p>
					</div>
				</div>
				<div class="nmaas-modal-footer">
					<button type="button" class="btn btn-danger" (click)="this.undeploy()">{{'UNDEPLOY_MODAL.YES_BUTTON' | translate}}</button>
					<button type="button" class="btn btn-primary" (click)="this.undeployModal.hide()">{{'UNDEPLOY_MODAL.CANCEL_BUTTON' | translate}}</button>
				</div>
			</nmaas-modal>
		
			<div class='row'>
				<h3>{{'APP_INSTANCE.INSTALLATION_PROGRESS.HEADER' | translate}}</h3>
				<hr>
				<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
					<nmaas-appinstanceprogress [stages]='getStages()' [activeState]="appInstanceStatus?.state"></nmaas-appinstanceprogress>
				</div>
				<p>{{'APP_INSTANCE.INSTALLATION_PROGRESS.STATE' | translate}}: {{appInstanceStatus?.userFriendlyState ? appInstanceStatus?.userFriendlyState : 'APP_INSTANCE.INSTALLATION_PROGRESS.DEFAULT_ERROR_STATE' | translate}}</p>
				<p>{{'APP_INSTANCE.INSTALLATION_PROGRESS.DETAILS' | translate}}: {{appInstanceStatus?.userFriendlyDetails}}</p>
			</div>
			
			<div class="row" *ngIf="appInstanceStatus?.state === AppInstanceState[AppInstanceState.FAILURE]">
				<div class="alert alert-danger">
					{{'APP_INSTANCE.INSTALLATION_PROGRESS.DEFAULT_ERROR_MESSAGE' | translate}}
				</div>
			</div>

			<div class="row" *ngIf="this.appInstanceStateHistory">
                <h3>{{'APP_INSTANCE.DEPLOYMENT_HISTORY.HEADER' | translate}}</h3>
				<hr>
				<table class="table table-hover table-condensed">
					<thead>
						<tr>
							<th>{{'APP_INSTANCE.DEPLOYMENT_HISTORY.TIMESTAMP' | translate}}</th>
                           <th>{{'APP_INSTANCE.DEPLOYMENT_HISTORY.STATE_TRANSITIONS' | translate}}</th>
							<th>&nbsp;</th>
						</tr>
					</thead>
					<tbody>
						<ng-template ngFor let-history [ngForOf]="this.appInstanceStateHistory" let-isLast="last">
							<tr>
								<td>{{history.timestamp | date:'medium'}}</td>
                                <td *ngIf="history.previousState !== null">{{history.previousState}}<span class="glyphicon glyphicon-arrow-right" style="padding-left: 5px;padding-right: 5px"></span>{{history.currentState}}</td>
                                <td *ngIf="history.previousState === null">{{history.currentState}}</td>
							</tr>
						</ng-template>
					</tbody>
				</table>
			</div>

            <div class="row" [ngClass]="{'collapse': storage.has('appConfig_' + appInstanceId.toString()) || appInstanceStatus?.state > AppInstanceState.CONFIGURATION_AWAITING}" >
				<div class="col-xs-12">
					<h3>{{'APP_INSTANCE.CONFIGURATION.HEADER' | translate}}</h3>
					<hr>
					<ul class="nav nav-tabs">
						<li class="active"><a data-toggle="tab" href="#configForm">{{'APP_INSTANCE.CONFIGURATION.CONFIGURATION_TAB' | translate}}</a> </li>
						<li> <a data-toggle="tab" href="#advanced">{{'APP_INSTANCE.CONFIGURATION.ADVANCED_TAB' | translate}}</a> </li>
						<li *ngIf="additionalParametersTemplate"> <a data-toggle="tab" href="#additionalParameters">{{'APP_INSTANCE.CONFIGURATION.ADDITIONAL_TAB' | translate}}</a> </li>
					</ul>
					<div class="tab-content" style="padding-top: 10px">
						<div id="configForm" class="tab-pane fade in active">
							<json-schema-form *ngIf="configurationTemplate"
											  [form]="configurationTemplate"
											  [options]="jsonFormOptions"
											  [framework]="bootstrap-3"
											  [language]="en"
											  (onChanges)="changeConfiguration($event)">
							</json-schema-form>
						</div>
						<div id="advanced" class="tab-pane fade" style="padding-bottom: 10px">
							<form [formGroup]="configAdvancedTab">
								<div class="form-group" [ngClass]="{'has-error': configAdvancedTab.controls.storageSpace.invalid && configAdvancedTab.controls.storageSpace.dirty,
																	'has-success': configAdvancedTab.controls.storageSpace.valid && configAdvancedTab.controls.storageSpace.dirty}">
									<label class="control-label" for="storageSpace">{{'APP_INSTANCE.CONFIGURATION.STORAGE_SPACE' | translate}} (GB):</label>
									<input type="text" class="form-control" placeholder="{{'APP_INSTANCE.DEFAULT_VALUE' | translate}}: {{app?.appDeploymentSpec.defaultStorageSpace}}"
										   formControlName="storageSpace" id="storageSpace">
								</div>
							</form>
						</div>
						<div id="additionalParameters" class="tab-pane fade" style="padding-bottom: 10px" *ngIf="additionalParametersTemplate">
							<json-schema-form
									[form]="additionalParametersTemplate"
									[options]="jsonFormOptions"
									[framework]="bootstrap-3"
									[language]="en"
									(onChanges)="changeAdditionalParameters($event)">

							</json-schema-form>
						</div>
						<p *ngIf="requiredFields"><strong class="text-danger">*</strong> = {{'APP_INSTANCE.REQUIRED_FIELDS' | translate}}</p>
						<button type="button" class="btn btn-success" [disabled]="!isValid() || !configAdvancedTab.valid" (click)="applyConfiguration()">{{'APP_INSTANCE.APPLY_CONFIG_BUTTON' | translate}}</button>
					</div>
				</div>
			</div>
			<hr>
			<nmaas-modal-app-restart [appInstanceId]="appInstanceId" [domainId]="appInstance?.domainId"></nmaas-modal-app-restart>
		</div>
	
