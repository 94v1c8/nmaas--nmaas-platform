		
		<div class="container">
			<div class="row">
				<div class="col-xs-4 col-sm-3 col-md-3 col-lg-2">
					<div class="thumbnail">
						<img [src]="appImagesService.getAppLogoUrl(app?.id) | secure" onError="this.src='assets/images/app-logo-example.png'"/>
					</div>
				</div>
				<div class="col-xs-8 col-sm-9 col-md-9 col-lg-10">
					<div class="row">
						<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
							<h2>{{appInstance?.name}}</h2>
							<h3>{{app?.name}}</h3>
						</div>
						<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">				
							<div class="btn-group pull-right">
								<a role="button" href="{{app?.wwwUrl}}" class="btn btn-default">WWW</a>
								<a role="button" href="{{app?.sourceUrl}}" class="btn btn-default">Source</a>
								<a role="button" href="{{app?.issuesUrl}}" class="btn btn-default">Issues</a>
							</div>
						</div>
					</div>
					
					<hr>
					<div class="row">
						<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
							Version: {{app?.version}}
						</div>
						<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
							License: {{app?.license}}
						</div>
					</div>
					<div class="row">
						<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
							Tags: {{app?.tags.join(", ")}}
						</div>
					</div>
					<hr>
					<div class="row">
						<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
							<p>
								<span>Rating:</span>
								<rate [pathUrl]="'/apps/' + app?.id + '/rate'"></rate>
							</p>
						</div>
						<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">	
							<p>
								<span>My rating:</span>
								<rate [editable]="true" (onChange)="onRateChanged()" [pathUrl]="'/apps/' + app?.id + '/rate/my'"></rate>
							</p>
						</div>
						<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
							<div class = "btn-group pull-right" *ngIf="appInstanceStatus?.state !== AppInstanceState[AppInstanceState.FAILURE]">
								<a *ngIf="appInstanceStatus?.state === AppInstanceState[AppInstanceState.RUNNING] && appInstance?.url" href="{{appInstance?.url}}" class = "btn btn-success" role = "button">Go to app</a>
								<button class = "btn btn-danger" (click)="undeploy()">Undeploy</button>
							</div>
							<div class="btn-group pull-right" *ngIf="appInstanceStatus?.state === AppInstanceState[AppInstanceState.RUNNING]">
								<button class="btn btn-primary" (click)="this.modal.show()">Restart</button>
							</div>
							<div class="btn-group pull-right" *ngIf="appInstanceStatus?.state === AppInstanceState[AppInstanceState.FAILURE]">
								<button class="btn btn-primary" (click)="redeploy()">Redeploy</button>
							</div>
						</div>
					</div>
				</div>
			</div>	
		
			<div class='row'>
				<h3>Installation progress</h3>
				<hr>
				<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
					<nmaas-appinstanceprogress [stages]='getStages()' [activeState]="appInstanceStatus?.state"></nmaas-appinstanceprogress>
				</div>
				<p>State: {{appInstanceStatus?.userFriendlyState ? appInstanceStatus.userFriendlyState : 'Something went wrong'}}</p>
				<p>Details: {{appInstanceStatus?.userFriendlyDetails}}</p>
			</div>
			
			<div class="row" *ngIf="appInstanceStatus?.state === AppInstanceState[AppInstanceState.FAILURE]">
				<div class="alert alert-danger">
					Please contact support
				</div>
			</div>

			<div class="row" *ngIf="this.appInstanceStateHistory">
                <h3>Deployment history</h3>
				<hr>
				<table class="table table-hover table-condensed">
					<thead>
						<tr>
							<th>Timestamp</th>
                           <th>State transitions</th>
							<th>&nbsp;</th>
						</tr>
					</thead>
					<tbody>
						<ng-template ngFor let-history [ngForOf]="this.appInstanceStateHistory" let-isLast="last">
							<tr>
								<td>{{history.timestamp | date:'medium'}}</td>
                                <td *ngIf="history.previousState !== null">{{history.previousState}}<span class="glyphicon glyphicon-arrow-right" style="padding-left: 5px;padding-right: 5px"></span>{{history.currentState}}</td>
                                <td *ngIf="history.previousState === null">{{history.currentState}}</td>
							</tr>
						</ng-template>
					</tbody>
				</table>
			</div>

			<div class="row" [ngClass]="{'collapse': appConfiguration?.confirmed}" >
				<div class="col-xs-12">
					<h3>Configuration</h3>
					<hr>
					<ul class="nav nav-tabs">
						<li class="active"><a data-toggle="tab" href="#configForm">Configuration</a> </li>
						<li> <a data-toggle="tab" href="#advanced">Advanced</a> </li>
					</ul>
					<div class="tab-content" style="padding-top: 10px">
						<div id="configForm" class="tab-pane fade in active">
							<json-schema-form *ngIf="configurationTemplate"
											  [form]="configurationTemplate"
											  [options]="jsonFormOptions"
											  [framework]="bootstrap-3"
											  [language]="en"
											  (onChanges)="changeConfiguration($event)">
							</json-schema-form>
						</div>
						<div id="advanced" class="tab-pane fade" style="padding-bottom: 10px">
							<label class="control-label" for="storageSpace">Storage space (GB):</label>
							<input class="form-control no-spin" placeholder="Default value: {{app?.appDeploymentSpec.defaultStorageSpace}}" [(ngModel)]="appConfiguration.storageSpace" id="storageSpace"
								   name="storageSpace" type="number" />
						</div>
						<p *ngIf="requiredFields"><strong class="text-danger">*</strong> = required fields</p>
						<button type="button" class="btn btn-success" [disabled]="!isValid()" (click)="applyConfiguration()">Apply configuration</button>
					</div>
				</div>
			</div>
			<hr>
			<nmaas-modal-app-restart [appInstanceId]="appInstanceId" [domainId]="appInstance?.domainId"></nmaas-modal-app-restart>
		</div>


	
