<div class="panel panel-default">
    <div class="panel-heading">{{ 'CLUSTERS.TITLE' | translate }}</div>
    <div class="panel-body">
        <form *ngIf="cluster" (submit)="submit()" class="form-horizontal" #clusterForm="ngForm">
            <div class="panel-default panel-heading">{{ 'CLUSTERS.REST_API' | translate }}</div>
            <div class="panel-body">
                <div class="form-group">
                    <label for="useKClusterApi" class="col-sm-2 control-label">{{ 'CLUSTERS.USER_REST_API' | translate }}</label>
                    <div class="col-sm-10">
                        <input type="checkbox" id="useKClusterApi" name="useKClusterApi"
                               [(ngModel)]="cluster.api.useKClusterApi" [checked]="cluster.api.useKClusterApi == true" [disabled]="isInMode(ComponentMode.VIEW)">
                    </div>
                </div>
                <div class="form-group" *ngIf="cluster.api.useKClusterApi">
                    <label for="apihostaddress" class="col-sm-2 control-label">{{ 'CLUSTERS.HOST_ADDRESS' | translate }}</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="apihostaddress" name="apihostaddress"
                               [(ngModel)]="cluster.api.restApiHostAddress" [disabled]="isInMode(ComponentMode.VIEW)" pattern="[0-9.]*" required #restaddress="ngModel">
                        <div class="alert alert-danger" *ngIf="restaddress.invalid && (restaddress.dirty || restaddress.touched)">
                            <div *ngIf="restaddress.errors.required">{{ 'CLUSTERS.REST_API_HOST_ADDRESS_REQUIRED_MESSAGE' | translate }}</div>
                            <div *ngIf="restaddress.errors.pattern">{{ 'CLUSTERS.REST_API_HOST_ADDRESS_VALIDATION_MESSAGE' | translate }}</div>
                        </div>
                    </div>
                </div>
                <div class="form-group" *ngIf="cluster.api.useKClusterApi">
                    <label for="apihostport" class="col-sm-2 control-label">{{ 'CLUSTERS.HOST_PORT' | translate }}</label>
                    <div class="col-sm-10">
                        <input type="number" class="form-control no-spin" id="apihostport" name="apihostport"
                               [(ngModel)]="cluster.api.restApiPort" [disabled]="isInMode(ComponentMode.VIEW)" required #apiport="ngModel">
                        <div class="alert alert-danger" *ngIf="apiport.invalid && (apiport.dirty || apiport.touched)">
                            <div *ngIf="apiport.errors.required">{{ 'CLUSTERS.REST_API_PORT_REQUIRED_MESSAGE' | translate }}</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="panel-default panel-heading">{{ 'CLUSTERS.INGRESS' | translate }}</div>
            <div class="panel-body">
                <div class="form-group">
                    <label for="ingresscontrollerconfigoption" class="col-sm-2 control-label">{{ 'CLUSTERS.CONTROLLER_CONFIG_OPTION' | translate }}</label>
                    <div class="col-sm-10">
                        <select class="form-control" id="ingresscontrollerconfigoption" name="ingresscontrollerconfigoption"
                                [(ngModel)]="cluster.ingress.controllerConfigOption" [disabled]="isInMode(ComponentMode.VIEW)" required>
                            <option *ngFor="let configOption of getKeys(controllerConfigOption)" [value]="controllerConfigOption.get(configOption)">{{configOption}}</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="suportedingressclass" class="col-sm-2 control-label">{{ 'CLUSTERS.SUPPORTED_INGRESS_CLASS' | translate }}</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="suportedingressclass" name="suportedingressclass"
                               [(ngModel)]="cluster.ingress.supportedIngressClass" [disabled]="isInMode(ComponentMode.VIEW)">
                    </div>
                </div>
                <div class="form-group">
                    <label for="ingresscontrollerchartname" class="col-sm-2 control-label">{{ 'CLUSTERS.CONTROLLER_CHART_NAME' | translate }}</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="ingresscontrollerchartname" name="ingresscontrollerchartname"
                               [(ngModel)]="cluster.ingress.controllerChartName" [disabled]="isInMode(ComponentMode.VIEW)">
                    </div>
                </div>
                <div class="form-group">
                    <label for="ingresscontrollerchartarchive" class="col-sm-2 control-label">{{ 'CLUSTERS.CONTROLLER_CHART_ARCHIVE' | translate }}</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="ingresscontrollerchartarchive" name="ingresscontrollerchartarchive"
                               [(ngModel)]="cluster.ingress.controllerChartArchive" [disabled]="isInMode(ComponentMode.VIEW)">
                    </div>
                </div>
                <div class="form-group">
                    <label for="ingressresourceconfigoption" class="col-sm-2 control-label">{{ 'CLUSTERS.RESOURCE_CONFIG_OPTION' | translate }}</label>
                    <div class="col-sm-10">
                        <select class="form-control" id="ingressresourceconfigoption" name="ingressresourceconfigoption"
                                [(ngModel)]="cluster.ingress.resourceConfigOption" [disabled]="isInMode(ComponentMode.VIEW)" required>
                            <option *ngFor="let configOption of getKeys(resourceConfigOption)" [value]="resourceConfigOption.get(configOption)">{{configOption}}</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="ingressexternalservicedomain" class="col-sm-2 control-label">{{ 'CLUSTERS.EXTERNAL_SERVICE_DOMAIN' | translate }}</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="ingressexternalservicedomain" name="ingressexternalservicedomain"
                               [(ngModel)]="cluster.ingress.externalServiceDomain" [disabled]="isInMode(ComponentMode.VIEW)">
                    </div>
                </div>
                <div class="form-group">
                    <label for="ingresstlssupported" class="col-sm-2 control-label">{{ 'CLUSTERS.TLS_SUPPORTED' | translate }}</label>
                    <div class="col-sm-10">
                        <input type="checkbox" id="ingresstlssupported" name="ingresstlssupported"
                               [(ngModel)]="cluster.ingress.tlsSupported" [checked]="cluster.ingress.tlsSupported == true" [disabled]="isInMode(ComponentMode.VIEW)">
                    </div>
                </div>
                <div class="form-group" *ngIf="cluster.ingress.tlsSupported">
                    <label for="ingresscertificateconfigoption" class="col-sm-2 control-label">{{ 'CLUSTERS.INGRESS_CERTIFICATE_CONFIG_OPTION' | translate }}</label>
                    <div class="col-sm-10">
                        <select class="form-control" id="ingresscertificateconfigoption" name="ingresscertificateconfigoption"
                        [(ngModel)]="cluster.ingress.certificateConfigOption" [disabled]="isInMode(ComponentMode.VIEW)" required>
                        <option *ngFor="let configOption of getKeys(certificateConfigOption)" [value]="certificateConfigOption.get(configOption)">{{configOption}}</option>
                        </select>
                    </div>
                </div>
                <div class="form-group" *ngIf="cluster.ingress.tlsSupported">
                    <label for="ingressissuerorwildcardname" class="col-sm-2 control-label">{{ 'CLUSTERS.INGRESS_ISSUER_OR_WILDCARD_NAME' | translate }}</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="ingressissuerorwildcardname" name="ingressissuerorwildcardname"
                               [(ngModel)]="cluster.ingress.issuerOrWildcardName" [disabled]="isInMode(ComponentMode.VIEW)">
                    </div>
                </div>
            </div>

            <div class="panel-default panel-heading">{{ 'CLUSTERS.DEPLOYMENT' | translate }}</div>
            <div class="panel-body">
                <div class="form-group">
                    <label for="deploymentnamespaceconfigoption" class="col-sm-2 control-label">{{ 'CLUSTERS.NAMESPACE_CONFIG_OPTION' | translate }}</label>
                    <div class="col-sm-10">
                        <select class="form-control" id="deploymentnamespaceconfigoption" name="deploymentnamespaceconfigoption"
                                [(ngModel)]="cluster.deployment.namespaceConfigOption" [disabled]="isInMode(ComponentMode.VIEW)" required>
                            <option *ngFor="let configOption of getKeys(namespaceConfigOption)" [value]="namespaceConfigOption.get(configOption)">{{configOption}}</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="deploymentdefaultnamespace" class="col-sm-2 control-label">{{ 'CLUSTERS.DEFAULT_NAMESPACE' | translate }}</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="deploymentdefaultnamespace" name="deploymentdefaultnamespace"
                               [(ngModel)]="cluster.deployment.defaultNamespace" [disabled]="isInMode(ComponentMode.VIEW)">
                    </div>
                </div>
                <div class="form-group">
                    <label for="deploymentdefaultstorageclass" class="col-sm-2 control-label">{{ 'CLUSTERS.DEFAULT_STORAGE_CLASS' | translate }}</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="deploymentdefaultstorageclass" name="deploymentdefaultstorageclass"
                               [(ngModel)]="cluster.deployment.defaultStorageClass" [disabled]="isInMode(ComponentMode.VIEW)">
                    </div>
                </div>
                <div class="form-group">
                    <label for="useinclustergitlabinstance" class="col-sm-2 control-label">{{ 'CLUSTERS.USER_LOCAL_GITLAB_INSTANCE' | translate }}</label>
                    <div class="col-sm-10">
                        <input type="checkbox" id="useinclustergitlabinstance" name="useinclustergitlabinstance"
                               [(ngModel)]="cluster.deployment.useInClusterGitLabInstance" [checked]="cluster.deployment.useInClusterGitLabInstance == true" [disabled]="isInMode(ComponentMode.VIEW)">
                    </div>
                </div>
                <div class="form-group">
                    <label for="forceDedicatedWorkers" class="col-sm-2 control-label">{{ 'CLUSTERS.FORCE_DEDICATED_WORKERS' | translate }}</label>
                    <div class="col-sm-10">
                        <input type="checkbox" id="forceDedicatedWorkers" name="forceDedicatedWorkers"
                               [(ngModel)]="cluster.deployment.forceDedicatedWorkers" [checked]="cluster.deployment.forceDedicatedWorkers == true" [disabled]="isInMode(ComponentMode.VIEW)">
                    </div>
                </div>
                <div class="form-group">
                    <label for="smtpServerHostname" class="col-sm-2 control-label">SMTP server hostname: </label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="smtpServerHostname" name="smtpServerHostname"
                               [(ngModel)]="cluster.deployment.smtpServerHostname" [disabled]="isInMode(ComponentMode.VIEW)" required #smtpServerHostname="ngModel">
                        <div class="alert alert-danger" *ngIf="smtpServerHostname.invalid && (smtpServerHostname.dirty || smtpServerHostname.touched)">
                            <div *ngIf="smtpServerHostname.errors.required">SMTP server hostname is required</div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="smtpServerPort" class="col-sm-2 control-label">SMTP server port: </label>
                    <div class="col-sm-10">
                        <input type="number" class="form-control no-spin" id="smtpServerPort" name="smtpServerPort"
                               [(ngModel)]="cluster.deployment.smtpServerPort" [disabled]="isInMode(ComponentMode.VIEW)" required #smtpServerPort="ngModel">
                        <div class="alert alert-danger" *ngIf="smtpServerPort.invalid && (smtpServerPort.dirty || smtpServerPort.touched)">
                            <div *ngIf="smtpServerPort.errors.required">SMTP server port is required</div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="smtpServerUsername" class="col-sm-2 control-label">SMTP server username: </label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="smtpServerUsername" name="smtpServerUsername"
                               [(ngModel)]="cluster.deployment.smtpServerUsername" [disabled]="isInMode(ComponentMode.VIEW)">
                    </div>
                </div>
                <div class="form-group">
                    <label for="smtpServerPass" class="col-sm-2 control-label">SMTP server password: </label>
                    <div class="col-sm-10">
                        <input type="password" class="form-control" id="smtpServerPass" name="smtpServerPass"
                               [(ngModel)]="cluster.deployment.smtpServerPassword" [disabled]="isInMode(ComponentMode.VIEW)">
                    </div>
                </div>
            </div>

            <div class="panel-default panel-heading">{{ 'CLUSTERS.ATTACH_POINT' | translate }}</div>
            <div class="panel-body">
                <div class="form-group">
                    <label for="routername" class="col-sm-2 control-label">{{ 'CLUSTERS.ROUTER_NAME' | translate }}</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="routername" name="routername"
                               [(ngModel)]="cluster.attachPoint.routerName" [disabled]="isInMode(ComponentMode.VIEW)">
                    </div>
                </div>

                <div class="form-group">
                    <label for="routerid" class="col-sm-2 control-label">{{ 'CLUSTERS.ROUTER_ID' | translate }}</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="routerid" name="routerid"
                               [(ngModel)]="cluster.attachPoint.routerId" [disabled]="isInMode(ComponentMode.VIEW)">
                    </div>
                </div>

                <div class="form-group">
                    <label for="routerintname" class="col-sm-2 control-label">{{ 'CLUSTERS.ROUTER_INTERFACE_NAME' | translate }}</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="routerintname" name="routerintname"
                               [(ngModel)]="cluster.attachPoint.routerInterfaceName" [disabled]="isInMode(ComponentMode.VIEW)">
                    </div>
                </div>
            </div>

            <div class="panel-default panel-heading">{{ 'CLUSTERS.EXTERNAL_NETWORKS' | translate }}</div>
            <div class="panel-body">
                <table class="table table-hover table-condensed">
                    <thead>
                    <tr>
                        <th>{{ 'CLUSTERS.ADDRESS' | translate }}</th>
                        <th>{{ 'CLUSTERS.NETWORK' | translate }}</th>
                        <th>{{ 'CLUSTERS.NETMASK_LENGTH' | translate }}</th>
                        <th>{{ 'CLUSTERS.ASSIGNED' | translate }}</th>
                        <th>{{ 'CLUSTERS.ASSIGNED_SINCE' | translate }}</th>
                        <th>{{ 'CLUSTERS.ASSIGNED_TO' | translate }}</th>
                        <th>&nbsp;</th>
                    </tr>
                    </thead>
                    <tbody>
                    <ng-template ngFor let-extnetwork [ngForOf]="cluster.externalNetworks" let-i="index" [ngForTrackBy]="trackByFn">
                        <tr>
                            <td>
                                <input type="text" class="form-control" [name]="'extnetextip'+i"
                                       [(ngModel)]="extnetwork.externalIp" [disabled]="isInMode(ComponentMode.VIEW)" required pattern="[0-9.]*" #ip="ngModel">
                                <div class="alert alert-danger" *ngIf="ip.invalid && (ip.dirty || ip.touched)">
                                    <div *ngIf="ip.errors.required">{{ 'CLUSTERS.IP_REQUIRED_MESSAGE' | translate }}</div>
                                    <div *ngIf="ip.errors.pattern">{{ 'CLUSTERS.IP_VALIDATION_MESSAGE' | translate }}</div>
                                </div>
                            </td>
                            <td>
                                <input type="text" class="form-control" [name]="'extnetextnet'+i"
                                       [(ngModel)]="extnetwork.externalNetwork" [disabled]="isInMode(ComponentMode.VIEW)" required pattern="[0-9.]*" #network="ngModel">
                                <div class="alert alert-danger" *ngIf="network.invalid && (network.dirty || network.touched)">
                                    <div *ngIf="network.errors.required">{{ 'CLUSTERS.NETWORK_REQUIRED_MESSAGE' | translate }}</div>
                                    <div *ngIf="network.errors.pattern">{{ 'CLUSTERS.NETWORK_ADDRESS_VALIDATION_MESSAGE' | translate }}</div>
                                </div>
                            </td>
                            <td>
                                <input type="text" class="form-control" [name]="'extnetmask'+i"
                                       [(ngModel)]="extnetwork.externalNetworkMaskLength" [disabled]="isInMode(ComponentMode.VIEW)" min="0" max="32" #mask="ngModel">
                                <div class="alert alert-danger" *ngIf="mask.invalid && (mask.dirty || mask.touched)">
                                    <div *ngIf="mask.errors.min || mask.errors.max">{{ 'CLUSTERS.MASK_VALIDATION_MESSAGE' | translate }}</div>
                                </div>
                            </td>
                            <td>
                                <input type="checkbox" [name]="'extnetassigned'+i"
                                       [(ngModel)]="extnetwork.assigned" [checked]="extnetwork.assigned == true" [disabled]="isInMode(ComponentMode.VIEW)">
                            </td>
                            <td>
                                <input type="text" class="form-control" [name]="'extnetassince'+i"
                                       [(ngModel)]="extnetwork.assignedSince" [disabled]="isInMode(ComponentMode.VIEW) || !extnetwork.assigned">
                            </td>
                            <td>
                                <input type="text" class="form-control" [name]="'extnetassto'+i"
                                       [(ngModel)]="extnetwork.assignedTo" [disabled]="isInMode(ComponentMode.VIEW) || !extnetwork.assigned">
                            </td>
                            <td class="text-right">
                                <button *ngIf="!isInMode(ComponentMode.VIEW)" type="button" class="btn btn-sm btn-danger"
                                        (click)="removeNetwork(extnetwork.id)">{{ 'CLUSTERS.REMOVE_BUTTON' | translate }}
                                </button>
                            </td>
                        </tr>
                    </ng-template>
                    <tr *ngIf="!isInMode(ComponentMode.VIEW)">
                        <td></td><td></td><td></td><td></td><td></td><td></td>
                        <td>
                            <button type="button" class="btn btn-sm btn-success"
                                    (click)="addNetwork()">{{ 'CLUSTERS.ADD_BUTTON' | translate }}
                            </button>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <div *ngIf="this.error" class="alert alert-danger">
                <p>{{this.error}}</p>
            </div>

            <button *ngIf="isInMode(ComponentMode.EDIT)" type="button"
                    class="btn btn-default" (click)="onModeChange()">{{ 'CLUSTERS.VIEW_BUTTON' | translate }}</button>
            <button *ngIf="!isInMode(ComponentMode.VIEW)" [disabled]="!clusterForm.form.valid" type="submit"
                    class="btn btn-primary">{{ 'CLUSTERS.SUBMIT_BUTTON' | translate }}</button>
            <button *ngIf="isInMode(ComponentMode.VIEW) && isModeAllowed(ComponentMode.EDIT)"
                    type="button" class="btn btn-default" (click)="onModeChange()">{{ 'CLUSTERS.EDIT_BUTTON' | translate }}</button>
        </form>
    </div>
</div>